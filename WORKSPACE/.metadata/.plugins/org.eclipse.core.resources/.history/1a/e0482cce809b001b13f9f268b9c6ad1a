



function load_timesheet_report() {
	var data = colect_config_date();
	if (data) {
		var method_get_url = encodeURIComponent(JSON.stringify(data));
		location.href = REPORT + '?' + method_get_url;
	}
}

$(document).ready(function () {
	$('#load').click(function(event) {
		load_timesheet_report();
	});
	$('.remove-row').click(function(event) {
		var tr = $(this).closest('tr');
		tr.remove();
	});
	$('.review-e-popup ul li span').click(function(){
		$('.mail-ctn').hide();
		$(this).data("target")).show();
	});
	
	$('#send_mail').click(function(event) {
		var data = {}; 
		var rows = $('#report_timesheet').find('tr');
		var  week = null;
		rows.each(function() {
			var email, resource, work_hours, timeoff, total, detail, comment;
			if ($(this).hasClass('week')) {
				week = $(this).find('td:first-child').html();
			} else if ($(this).hasClass('report-content')) {
				var td = $(this).find('td');
				td.each(function() {
					if ($(this).hasClass('email')) {
						email = $(this).html();
					} else if ($(this).hasClass('resource')) {
						resource = $(this).html();
					} else if ($(this).hasClass('work-hours')) {
						work_hours = $(this).html();
					} else if ($(this).hasClass('timeoff')) {
						timeoff = $(this).html();
					} else if ($(this).hasClass('total')) {
						total = $(this).html();
					} else if ($(this).hasClass('detail')) {
						detail = $(this).html();
					} else if ($(this).hasClass('comment')) {
						comment = $(this).html();
					}
				})
				if (data[week] == undefined) {
					data[week] = {};
				}
				if (data[week][email] == undefined) {
					data[week][email] = [];
				}
				data[week][email].push([resource, work_hours, timeoff, total, detail, comment]);
			}
		});
		get_template_content('components/sending_mail/report_timesheet.html', function(template) {
			
		});
	});
});



